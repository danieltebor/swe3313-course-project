@page "/confirm-order"

@inject NavigationManager NavigationManager

@using HanksMineralEmporium.Service.CheckoutService
@inject ICheckoutService CheckoutService

@* costs need to be adjusted*@


<MudStack>
    <MudPaper Class="pa-4" Style ="background:#124419">

        <MudButton Variant="Variant.Filled" Style="@($"color:{Colors.Shades.White}; background:{Colors.Grey.Default};")" OnClick="() => ReturnToShopping()">Return To Shopping</MudButton>
        <MudButton Variant="Variant.Filled" Style="@($"color:{Colors.Shades.White}; background:{Colors.Grey.Default};")" OnClick="() => BackToPayment()">Back To payment</MudButton>
        <br>
        <br>

        <MudStack>
            <MudPaper Class="pa-2" Style="background:#9A8716;">
                <MudText Align="Align.Center" Style="@($"color:{Colors.Shades.Black};")" Typo="Typo.h6">Are you sure you want to purchase?</MudText>
            </MudPaper>    
        </MudStack>
        <br>    

        <MudGrid>
            <MudItem Align="Align.Center" xs="6" md="6">
                <MudPaper Width="70%">
                    <MudList Clickable="@Clickable">
                        @foreach (var item in CheckoutService.GetItemsInCart())
                        {
                            <MudListItem>
                                @item.Name - $@item.Price
                            </MudListItem>
                        }                        
                    </MudList>
                </MudPaper>
            </MudItem>
        </MudGrid>

        <br>
        <MudStack>
            <MudPaper Class="pa-4" Style="background:#9A8716;">
                <MudText Align="Align.Center" Style="@($"color:{Colors.Shades.Black};")" Typo="Typo.body1">Card: **** **** **** 4444</MudText>
                <MudText Align="Align.Center" Style="@($"color:{Colors.Shades.Black};")" Typo="Typo.body1">Subtotal: $@(CalcSubtotal())</MudText>
                <MudText Align="Align.Center" Style="@($"color:{Colors.Shades.Black};")" Typo="Typo.body1">Tax: $0.00</MudText>
                <MudText Align="Align.Center" Style="@($"color:{Colors.Shades.Black};")" Typo="Typo.body1">Shipping: $0.00</MudText>
                
                <MudText Align="Align.Center" Style="@($"color:{Colors.Shades.Black};")" Typo="Typo.h5">  _________________</MudText>
                <MudText Align="Align.Center" Style="@($"color:{Colors.Shades.Black};")" Typo="Typo.h6">Total: $0.00 </MudText>
            </MudPaper>    
        </MudStack>
        <br>        


        <MudStack>
            <MudPaper Class="d-flex align-center flex-grow-1 gap-4" Elevation="0">
            <MudButton Class="py-2 d-flex flex-1" Variant="Variant.Filled" Style="@($"color:{Colors.Shades.White}; background:{Colors.Grey.Default};")" OnClick="() => CompleteOrder()">Complete Order</MudButton>
            </MudPaper>
        </MudStack>
    </MudPaper>    
</MudStack>


@code {
    public bool Clickable { get; set; }

    private void ReturnToShopping()
    {
        NavigationManager.NavigateTo("/");
    }

    private void BackToPayment()
    {
        NavigationManager.NavigateTo("/payment");
    }

    private void CompleteOrder() {
        NavigationManager.NavigateTo("/receipt");
    }

    private decimal CalcSubtotal()
    {
        decimal subtotal = 0;
        foreach (var item in CheckoutService.GetItemsInCart())
        {
            subtotal += item.Price;
        }
        return subtotal;
    }

    
}